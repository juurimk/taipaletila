{{ $data := index site.Data site.Language.Lang }}

{{/* Get sectionset for comparison section */}}
{{ $sectionset := index site.Params.sectionsets "comparison" | default "neutralset" }}

{{ if $data.comparison.comparison.enable }}
{{ with $data.comparison.comparison }}
{{"<!-- Start Comparison Table -->" | safeHTML}}
<section id="comparison" class="section comparison-section section-{{ $sectionset }}" aria-labelledby="comparison-title">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-12">
        {{"<!-- section title -->" | safeHTML}}
        <div class="title text-center ">
          <h2 id="comparison-title">{{ .title | safeHTML }}</h2>
          <!--<div class="border-meghna" style="background-color: var(--siteset-{{ $sectionset }}-h2);"></div>-->
          
          {{ if .description }}
          {{"<!-- comparison description -->" | safeHTML}}
          <div class="comparison-description text-center">
            </br><p>{{ .description | safeHTML }}</p>
          </div>
          {{"<!-- /comparison description -->" | safeHTML}}
          {{ end }}
        </div>
        {{"<!-- /section title -->" | safeHTML}}
      </div>
    </div>
    
    <div class="row justify-content-center">
      <div class="col-lg-10 col-md-12">
        <div class="comparison-table-wrapper">
          <div class="table-responsive">
            <table class="comparison-table table" {{ with .caption }}aria-describedby="comparison-caption"{{ end }}>
             {{ with .caption }}
              <caption id="comparison-caption" class="sr-only">
              {{ . }}
             </caption>
             {{ end }}

              <thead>
                <tr>
                  <th scope="col" class="feature-header">
                  {{ with .column_label }}{{ . }}{{ end }}
                  </th>
                  {{ range .columns }}
                  <th class="column-header {{ if .highlighted }}highlighted-column{{ end }}">
                    {{ .name }}
                    {{ if .highlighted }}
                    <div class="highlighted-badge">
                      {{ if eq site.Language.Lang "fi" }}SUOSITELTU{{ else }}RECOMMENDED{{ end }}
                    </div>
                    {{ end }}
                  </th>
                  {{ end }}
                </tr>
              </thead>
              <tbody>
                {{ $columns := .columns }}
                {{ $sectionsetVar := $sectionset }}
                {{ range $featureIndex, $feature := .features }}
                <tr class="{{ if (mod $featureIndex 2) }}even-row{{ else }}odd-row{{ end }}">
                  <td scope="row" class="feature-name">
                    {{ $feature }}
                  </td>
                  {{ range $columnIndex, $column := $columns }}
                  {{ $value := index .values $featureIndex }}
                  <td class="feature-value {{ if .highlighted }}highlighted-column{{ end }}">
                    {{ if $value }}
                    <span class="check-icon">✓</span>
                    {{ else }}
                    <span class="close-icon">✗</span>
                    {{ end }}
                  </td>
                  {{ end }}
                </tr>
                {{ end }}
              </tbody>
            </table>
          </div>
          
          {{ if .cta_text }}
          {{"<!-- comparison CTA -->" | safeHTML}}
          <div class="comparison-cta text-center">
            {{ if .cta_link }}
            <a href="{{ .cta_link | safeURL }}"
              class="btn btn-main"
              role="button"
              aria-label="{{ .cta_text }}">
             {{ .cta_text }}
            </a>
            {{ else }}
            <p>{{ .cta_text }}</p>
            {{ end }}
          </div>
          {{"<!-- /comparison CTA -->" | safeHTML}}
          {{ end }}
        </div>
      </div>
    </div>
  </div>
</section>
{{"<!-- /comparison table -->" | safeHTML}}
{{ end }}
{{ end }}